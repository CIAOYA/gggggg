# 03-11

*   使用包实现代码重用

    *   导入包

        *   Go程序以package语句打头,main包是特殊包,不能导入,唯一要求是声明一个main函数,不接受任何参数且不返回任何值,是程序的入口
        *   在main包可用import声明来导入其他包,能通过接口提供各种功能,比如math包提供常量Pi
    *   理解包的用途
        *   比如strings包包含处理字符串的函数,bytes处理字节,多用就知道
    *   第三方包
        *   优秀的第三方包都有卓越的文档,指出它们导出了哪些标识符,用之前看看文档
        *   前提是值得信任,确认可信任程度可以看多少人使用,或者阅读其源代码
        *   不选几年不更新的包,可能bug多惹,应选择开发方积极维护的包,随着时间会越来越稳定
        *   导入第三方包会增加程序的复杂性,如果你为了其中一个函数想去导入一个包那还是直接复制这个函数实在
    *   安装第三方包
        *   必须要像使用标准库一样用import语句导入它,在此之前必须先使用命令go get安装它,这个命令指向远程服务器中包的路径为参数,并在本地安装指定的包
            *   例如\:go get github.com/golang/example/stringutil
            *   这个包会被安装到环境变量GOPATH指定的路径中,所以可以在程序中使用它,看源代码打开目录src的文件
                *   例:%GOPATH%\src\github\golang\example\stringutil
            *   要使用这个包,就好好看文档说明罢
    *   管理第三方依赖
        *   很多语言都有包管理器,简化使用第三方包的工作,书上说莫得,但现在也有modules机制了,原型是vgo,下面都是爆金币的老东西(大概)
        *   更新包命令:
            *   go get -u 更新包  -u github.com地址 更新特定包  -u all 更新文件系统的所有包
        *   1.5版本引入了文件夹vendor方便将第三方模块添加进项目目录的文件夹vendor中
    *   创建包
        *   除了使用第三方包,有时可能需要创建包并发布到Github与人分享,可在上传前进行测试,创建一个测试文件
*   Go语言命名约定

    *   Go代码格式设置

        *   Go语言采取了实用而严格的态度,指定了格式设置约定,虽然并非是强制性的,但命令gofmt可以实现它,几乎整个Go社区都使用gofmt并希望按这个命令指定的方式设置代码格式
    *   使用gofmt

        *   无须了解代码格式设置约定,通过不断学习自然而然就会准守代码格式设置约定,对文件运行gofmt时,将把结果打印到标准输出但不修改原来的文件

            *   虽然介绍了工具修改,不过用goland设置gofmt后保存就可以自动执行代码格式化了
    *   配置文本编辑器

        *   很多文本编辑器都有第三方Go插件,草,写完才发现就是上面那个自动执行代码格式化,保存自动运行校正格式设置,就算以后用新编辑器直接搜就完事
    *   命名约定

        *   清晰的命名可提高代码的可读性和可维护性,有些约定是要求必须遵循的,而有些是否准信由程序员决定,比如大写字符打头的标识符将被导出,小写字母打头则不会

            *   var Foo := "bar" //Exoirted
            *   var foo := "bar" // Not Exported
        *   在Go语言中,不适用下划线表示私有这种,Go语言更遵循大小写约定

            *   对于包含多个单词的变量名,约定是骆驼拼写法或帕斯卡拼写法,具体使用哪种取决于变量是否需要被导出

                *   var fileName //骆驼拼写法
                *   var FileName //帕斯卡拼写法
        *   Go语言中,经常使用指出了数据类型的简短变量名,这让程序员能够专注于逻辑而不是变量,这种情况下,i表示整型(integer)数据类型,s表示字符串数据类型,b为布尔型之类的
    *   良好的命名

        *   func a(f float64) float64

            *   函数和变量名更简洁.但仅根据函数签名难以确定函数是做什么的
        *   func (t \*Triangle) Area() float64

            *   给方法和接收者参数都指定了贴切的名称,显然是用于三角形的,方法名也指出了是做什么的,只需通过接收者参数和方法名,就知道是计算三角形面积的,所以这个明显是比第一个好的
        *   接口名通常这样得到:

            *   在动词后面加上后缀er,形成一个名词,后缀er通常表示操作,因此这种命名方式表示操作,比如Reader,Writer和ByteWriter,在有些情况下,这样生产的接口名可能不是现成的英语单词,比如Twoer
        *   而对于要导出的函数,命名约定是尊重这样的事实,就是导入包后通过包名和函数名访问,比如math的Sqrt函数不是math.MathSqrt,而是math.Sqrt,就像是math.random一样,通过函数名就知道是做什么的了
    *   使用golint

        *   golint是Go语言提供的一个官方工具,根据指定的约定设置代码的格式,命令golint根据Go项目本身的约定查找风格方面的错误,默认不会安装golint,不过可以像下面这样安装它

            *   go  get -u github.com/golang/lint/golint

                *   核实是否正确安装,可在终端执行命令golint --help,安装后会显示帮助文本
        *   通过golint可以找出一些代码风格方面的问题,比如变量名包含下划线,会提供一些建议,从风格方面改进这些代码,还可以指出代码的哪些地方(行号和位置)需要注意,建议在Go项目中使用它
    *   使用godoc

        *   godoc是一款官方工具,通过分析Go语言源代码及其中的注释来生成文档,由于文档根据源代码生成,很大程度上避免了文档不同步(软件项目中常见的问题)的问题
        *   go get golang.org/x/tools/cmd/godoc
        *   一样的检查用命令godoc--help
        *   godoc能生成很多不同的输出,其中包括html,标准库文档就是使用godoc生成的,而很多第三方网站都提供了有关开源项目的HTML格式文档,遵循godoc约定意味着可以通过标准方式生成文档,这样生成和维护代码文档将易如反掌
        *   查看命令,比如查看strings包的文档,这将把strings包的文档打印到标准输出中,如果是UNIX系统可结合使用grep快速获悉方法的函数签名

            *   godoc strings
        *   Web服务器查看标准库文档,没网或速度有限可以用

            *   godoc -http=":6060"
        *   还能查看github第三方包的文档

            *   godoc \$GOPATH/src/github.com/BurntSushi/toml
            *   虽然开发人员会使用自己的约定,但godoc是实施标准,提供了轻松编写和读取文档的标准方式
    *   工作流程自动化

        *   如果使用的是UNIX操作系统,可使用Makefile来简化源代码编译、测试和检查工作,能将多个名称组合起来,在持续集成环境中也可使用它们来自动测试、检查和编译代码

            *   要运行这个脚本,只需执行命令make
        *   makefile可实现专业的开发流程,因为使用它们可在将代码提交到仓库时自动执行检查,而在项目中,运行make时发现文件格式不正确会生成相应的报告

